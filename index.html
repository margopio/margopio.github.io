<!DOCTYPE html>
<html>

    <head>
        <title>GitHub Static Page</title>
        <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.2/socket.io.js"></script>        
        <script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyCDR2DB9PN6Kv2F3NEGJUiG5vbRN7-hw4w"></script>

        <style>            
            #map {
                height: 100%;
            }

            /* Optional: Makes the sample page fill the window. */
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #clientsDropDown {
                position:absolute;
                bottom:0;
                right: 0;
                width: 35%;
                padding-bottom: 1%;
                z-index: 100;
            }

            #clientsOpen {
                background: url("images/open.png") no-repeat scroll 68px 10px #414142;
                color: #ececec;
                cursor: pointer;
                font-size: 1.5em;
                margin: -2px 0 0 70%;
                padding: 0 0.5em 0 1em;
                text-decoration: none;
                width: 7em;
            }

            #clientsCTA {
                background:#414142;
                width:100%;
                color: #CCCCCC;
                text-align: left;
                /*font-size: 1em;*/
                margin: 0;
                padding: 1em 0.5em 0.5em 0.5em;
                text-decoration: none;
                position: relative;
            }

            #clientsDropDown .clientsClose {
                background-image: url(images/close.png);
            }

            #clientsDropDown #clientsDashboard {
                display: none;
            }

            form { background: #000; padding: 3px; bottom: 0; right: 0; width: 100%; }    
            form input { border: 0; padding: 0.5em; width: 90%; margin-right: .5%; color: black; font-size: 1em}
            form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 0.5em; color: black }
            #messages { list-style-type: none; margin-bottom: 1em; padding: 0; }
            #messages li { padding: 0.2em 0.5em; font-size: 1em}
            #messages li:nth-child(odd) { background: gray; }
        </style>

    </head>

    <body>
        <nav class="navbar navbar-default navbar-static-top navbar-inverse">
            <div class="container">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="#"><span class="glyphicon glyphicon-home"></span> Home</a>
                    </li>                
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="navbar-right">
                        <a href="http://we-are-pos.azurewebsites.net"><span class="glyphicon glyphicon-book"></span> New POS Partners Site</a>
                    </li>
                </ul>
            </div>
        </nav>

        <h4 style="margin-left: 1em">Online Chat with Cross-Origin Resource Sharing (CORS), and Location-based Job Oepenings</h4>
  
        <div id="map"></div>

        <div id="clientsDropDown">
            <p id="clientsOpen">Online Chat</p>

            <div id="clientsDashboard">
                <div id="clientsCTA"> 
                    <ul id="messages"></ul>
                    <form action="">
                        <input id="m" autocomplete="off" /><button>Send</button>
                    </form>
                </div>   
            </div>
            <!-- /clientsDashboard -->
        </div>
        <!-- //clientsDropDown -->
                
        <script> 
            // First, create an object containing LatLng and population for each city.
            var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';

            var citymap = {
                losangeles: {
                    center: {lat: 34.050095, lng: -118.253165},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/bar-grill"
                },
                houston: {
                    center: {lat: 29.761055, lng: -95.462707},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/bbq"  
                },  
                washington: {
                    center: {lat: 39.058614, lng: -77.451909},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/bowling-alley"  
                },
                colorado: {
                    center: {lat: 39.749121, lng: -104.991165},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/brewery"  
                },
                grapevine : {
                    center: {lat: 32.890213, lng: -97.094444},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/casinos"  
                },
                kansascity : {
                    center: {lat: 39.085885, lng: -94.584811},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/comedy-clubs"  
                },
                helena  : {
                    center: {lat: 46.589421, lng: -112.038605},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/country-clubs"  
                },
                milwaukee : {
                    center: {lat: 43.038971, lng: -87.908267},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/eatertainment"  
                },
                westloopriverside : {
                    center: {lat: 41.881252, lng: -87.639118},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/greek-cuisine"  
                },
                sandiego : {
                    center: {lat: 32.7341871, lng: -117.216478},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/hospital"  
                },
                westdesmoines : {
                    center: {lat: 41.561931, lng: -93.782819},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/mexican-cuisine"  
                },
                oakbrookterrace : {
                    center: {lat: 41.846219, lng: -87.984889},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/pizza"  
                },
                lakeoswego : {
                    center: {lat: 45.422215, lng: -122.740823},
                    icon: iconBase + 'info-i_maps.png',
                    url: "http://we-are-pos.azurewebsites.net/index.php/markets/point-of-sale-for-senior-living-communities"  
                }
            };

            function getURL(lat, lng) {                 
                for (var city in citymap) {  	
                    var lat1 = citymap[city].center.lat.toString();    
                    if (lat === lat1) {                         
                        window.open(citymap[city].url);
                    } 
                }
            }

            function initMap() {                
                // Create the map.
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 5,
                    center: {lat: 37.090, lng: -95.712},
                    mapTypeId: 'roadmap'
                });

                // Construct the circle for each value in citymap.  
                for (var city in citymap) {                    
                    // Add the circle for this city to the map.
                    // var cityCircle = new google.maps.Circle({
                    //     strokeColor: '#FF0000',
                    //     strokeOpacity: 0.8,
                    //     strokeWeight: 2,
                    //     fillColor: '#FF0000',
                    //     fillOpacity: 0.35,
                    //     map: map,
                    //     center: citymap[city].center,
                    //     radius: 40000
                    // });

                    var marker = new google.maps.Marker({
                        position: citymap[city].center,
                        icon: citymap[city].icon,
                        map: map
                    });

                    
                    google.maps.event.addListener(cityCircle, 'click', function(ev){       
                        var str = this.getCenter().toString().split(",");      
                        var lat = str[0].slice(1);
                        var lng = str[1];     
                        getURL(lat, lng);
                    });
                }  
            }

            initMap();

        </script>

        <script>  
            var socket = io.connect("https://limitless-caverns-28604.herokuapp.com");
            $('form').submit(function() {        
                socket.emit('chat message', $('#m').val());
                $('#m').val('');
                return false;
            });

            socket.on('chat message', function(msg) {        
                $('#messages').append($('<li>').text(msg));        
            }); 

            $('#clientsOpen').click(function () {
                $('#clientsDropDown #clientsDashboard').slideToggle({
                direction: "up"
                }, 300);
                $(this).toggleClass('clientsClose');
            }); // end click

        </script> 
        
    </body>

</html>        
